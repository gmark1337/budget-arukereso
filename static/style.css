:root {
  --bg: #fafafa;
  --card: #fff;
  --ink: #111;
  --muted: #6b7280;
  --line: #e5e7eb;
  --radius: 14px;

  /* layout helpers for search bar */
  --trail-w: 120px; /* estimated width of trailing icon group */
  --clear-w: 36px;  /* clear button size */
  --gap-w: 12px;    /* gap between clear and trailing */
}

[data-theme="dark"] {
  --bg: #111827;
  --card: #1f2937;
  --ink: #f9fafb;
  --muted: #9ca3af;
  --line: #374151;
}

* { box-sizing: border-box; }
html,body { height:100%; }
body {
  margin:0; font:16px/1.5 system-ui,Segoe UI,Roboto,Arial;
  color:var(--ink); background:var(--bg);
}

/* Layout */
.container { max-width:1100px; margin:0 auto; padding:16px; }
.header { display:flex; align-items:center; gap:16px; justify-content:space-between; }
h1 { font-size:24px; margin:0; }

/* Search group with trailing icons */
.searchgroup { position:relative; display:flex; flex-direction:column; width:100%; max-width:640px; }
.searchgroup input {
  width:100%;
  padding:12px calc(var(--trail-w) + var(--clear-w) + var(--gap-w) + 14px) 12px 14px;
  border:1px solid var(--line);
  border-radius: var(--radius);
  background:var(--card); color:var(--ink);
  outline:none;
}

/* Clear button inside search bar (before trailing icons) */
.clear-btn {
  position:absolute;
  right: calc(var(--trail-w) + 12px);
  top:50%;
  transform:translateY(-50%);
  width:var(--clear-w); height:var(--clear-w);
  border:none; background:transparent;
  font-size:18px; color:var(--muted);
  cursor:pointer;
  display:none; /* only show when there is text */
}
.searchgroup input:not(:placeholder-shown) ~ .clear-btn {
  display:block;
}

.searchgroup .trailing {
  position:absolute; top:50%; right:8px; transform:translateY(-50%);
  display:flex; align-items:center; gap:8px; height:32px; padding:0 6px;
}
.divider { width:1px; height:18px; background:var(--line); }
.icon { width:36px; height:36px; border-radius:10px; border:1px solid var(--line);
  background:var(--card); color:var(--ink); display:grid; place-items:center; cursor:pointer;
}
.icon.ghost { background:var(--card); border-color:var(--line); }

/* Dark Mode tile */
.tile {
  width: 40px; height: 40px;
  border-radius: 12px;
  border: 1px solid var(--line);
  background: var(--card);
  display:grid; place-items:center;
  cursor:pointer;
  transition: background .25s ease, border-color .25s ease, box-shadow .25s ease, transform .05s ease;
  box-shadow: 0 1px 0 rgba(0,0,0,.03);
}
.tile:active { transform: scale(.98); }

.tile.light { background: var(--card); border-color: var(--line); }
.tile.dark  { background: var(--card); border-color: var(--line); }

/* SVG colors inside tile */
.tile.light .ico-ring  { stroke:#000; fill:none; stroke-width:2; }
.tile.light .ico-left  { fill:#000; }
.tile.light .ico-right { fill:var(--card); }
.tile.light .ico-dot   { fill:#000; }

.tile.dark  .ico-ring  { stroke:#fff; fill:none; stroke-width:2; }
.tile.dark  .ico-left  { fill:var(--card); }
.tile.dark  .ico-right { fill:#fff; }
.tile.dark  .ico-dot   { fill:#fff; }

.tile:hover { box-shadow: 0 6px 16px rgba(0,0,0,.12); }
[data-theme="dark"] .tile:hover { box-shadow: 0 6px 16px rgba(0,0,0,.35); }
.header .trailing .tile { width:38px; height:38px; }

/* Search history */
.history {
  position:absolute; top:calc(100% + 4px); left:0; right:0;
  background:var(--card); border:1px solid var(--line);
  border-radius: var(--radius); list-style:none; margin:0; padding:4px 0;
  max-height:240px; overflow:auto; z-index:20;
}
.history li { display:flex; justify-content:space-between; align-items:center;
  padding:8px 12px; cursor:pointer; gap:6px; }
.history li:hover { background:#f3f4f6; }
[data-theme="dark"] .history li:hover { background:#374151; }
.history .term { flex:1; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.history button { border:none; background:transparent; cursor:pointer; color:var(--muted); }
.hidden { display:none !important; }

.results-title { margin:8px 0 12px; font-size:18px; color:var(--muted); }

/* Grid */
.grid { display:grid; grid-template-columns: repeat(4, minmax(0,1fr)); gap:16px; }
@media (max-width:1024px){ .grid{ grid-template-columns:repeat(3,1fr); } }
@media (max-width:720px){ .grid{ grid-template-columns:repeat(2,1fr); } }

.card {
  background:var(--card); border:1px solid var(--line); border-radius:var(--radius);
  padding:12px; display:flex; flex-direction:column; gap:8px; cursor:pointer;
}
.card img { width:100%; aspect-ratio:1/1; object-fit:cover; border-radius:10px; background:#f3f4f6; }
.card .title { font-weight:600; }
.card .meta { color:var(--muted); font-size:14px; }

.empty { color:var(--muted); }

/* Filter sheet */
.sheet { position:fixed; inset:0; background:rgba(0,0,0,.2); display:none; }
.sheet[aria-hidden="false"] { display:block; }
.sheet-inner {
  position:absolute; right:0; top:0; bottom:0; width:360px; max-width:100%;
  background:var(--card); border-left:1px solid var(--line); padding:16px; overflow:auto;
}
.sheet-header { display:flex; align-items:center; justify-content:space-between; margin-bottom:8px; }
.sheet-header h2 { margin:0; }
.block { margin:16px 0; display:block; }
.chips { display:flex; gap:8px; flex-wrap:wrap; }
.chip { padding:8px 12px; border:1px solid var(--line); border-radius:999px; background:var(--card); color:var(--ink); }
.chip.active { background:#111; color:#fff; border-color:#111; }

.btn { padding:10px 14px; border-radius:10px; border:1px solid var(--ink); background:var(--ink); color:#fff; }
.btn.ghost { background:var(--card); color:var(--ink); border:1px solid var(--line); }
.sheet-actions { display:flex; justify-content:space-between; gap:8px; }

/* Fix Apply button contrast in dark mode */
[data-theme="dark"] .sheet-actions .btn {
  background: #fff;
  color: #000;
  border-color: #fff;
}

/* Sort menu */
.menu {
  position:absolute; top:74px; right:16px; background:var(--card); border:1px solid var(--line);
  border-radius:12px; padding:6px; display:none;
}
.menu[aria-hidden="false"] { display:block; }
.menu button { display:block; width:180px; text-align:left; padding:10px 12px; border:none; background:var(--card); color:var(--ink); }
.menu button:hover { background:#f3f4f6; }
[data-theme="dark"] .menu button:hover { background:#374151; }

/* Dialog */
.dialog { border:none; border-radius:16px; width:min(860px,92%); background:var(--card); color:var(--ink); }
.dialog::backdrop { background:rgba(0,0,0,.35); }
.dialog-body { display:grid; grid-template-columns: 1fr 1fr; gap:16px; padding:16px; }
.dialog-body img { width:100%; border-radius:12px; background:#f3f4f6; }
.dialog-actions { display:flex; justify-content:flex-end; padding:12px 16px; border-top:1px solid var(--line); }
.details h3 { margin:0 0 6px; }

/* Two-thumb price range */
.range { position:relative; height:36px; margin:10px 2px 22px; }
.range .track {
  position:absolute; top:50%; left:0; right:0; height:6px; transform:translateY(-50%);
  background:#e5e7eb; border-radius:999px;
}
[data-theme="dark"] .range .track { background:#374151; }
.range .fill {
  position:absolute; top:50%; height:6px; transform:translateY(-50%);
  background:#111; border-radius:999px;
}
.range .thumb {
  position:absolute; top:50%; transform:translate(-50%, -50%);
  width:22px; height:22px; border-radius:50%; border:2px solid #111; background:var(--card); cursor:grab;
}
.range .thumb:active { cursor:grabbing; }
